<mxfile host="app.diagrams.net" modified="2024-05-22T07:18:28.355Z" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36" etag="VVobu4DCT8EyAqJfeK7k" version="24.4.4" type="github">
  <diagram id="C5RBs43oDa-KdzZeNtuy" name="Page-1">
    <mxGraphModel dx="1434" dy="746" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="WIyWlLk6GJQsqaUBKTNV-0" />
        <mxCell id="WIyWlLk6GJQsqaUBKTNV-1" parent="WIyWlLk6GJQsqaUBKTNV-0" />
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="HLwu8Gzehdd7tzMXg7ss-0" target="HLwu8Gzehdd7tzMXg7ss-6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-0" value="19번 db 해당 테이블&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;현시점 마지막&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;index값 가져오기&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="80" y="180" width="150" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-1" value="로그데이터" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="40" y="38" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="HLwu8Gzehdd7tzMXg7ss-4" target="HLwu8Gzehdd7tzMXg7ss-0">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-4" value="각 테이블 index 값&amp;nbsp;&lt;div&gt;가져오기&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="80" y="80" width="150" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="HLwu8Gzehdd7tzMXg7ss-6" target="HLwu8Gzehdd7tzMXg7ss-8">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-6" value="&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;각 테이블 인덱스 값+1 ~ 현시점 마지막&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;index값&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;데이터 select&amp;nbsp;&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="80" y="270" width="150" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-8" value="가져온 data 20번 db insert&amp;nbsp;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="80" y="360" width="150" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" source="HLwu8Gzehdd7tzMXg7ss-11" target="HLwu8Gzehdd7tzMXg7ss-16" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-11" value="20번 db 업데이트 테이블 truncate" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="550" y="180" width="150" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-12" value="업데이트 데이터" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="495" y="38" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" source="HLwu8Gzehdd7tzMXg7ss-14" target="HLwu8Gzehdd7tzMXg7ss-11" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-14" value="19번 db 각 테이블 전체 데이터&amp;nbsp;&lt;span style=&quot;background-color: initial;&quot;&gt;가져오기&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="550" y="80" width="150" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-15" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" source="HLwu8Gzehdd7tzMXg7ss-16" target="HLwu8Gzehdd7tzMXg7ss-17" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-16" value="&lt;div&gt;가져온 데이터 20번 db 업데이트 테이블에 insert&amp;nbsp;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="550" y="270" width="150" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-17" value="20번 db 업데이트 테이블, 본 테이블 merge" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="550" y="360" width="150" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-18" value="RFM" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="55" y="500" width="50" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-21" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="HLwu8Gzehdd7tzMXg7ss-19" target="HLwu8Gzehdd7tzMXg7ss-20">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-19" value="최근 1년간 로그인 기록이 있는 id, 로그인 시간 추출" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="80" y="530" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-24" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="HLwu8Gzehdd7tzMXg7ss-20" target="HLwu8Gzehdd7tzMXg7ss-22">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-20" value="추출한 데이터로 데이터프레임 2개 생성 (df, df2)" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="80" y="620" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-25" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="HLwu8Gzehdd7tzMXg7ss-22" target="HLwu8Gzehdd7tzMXg7ss-23">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-22" value="df2 로그인 시간 기준 내림차순 정렬(일 단위)" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="80" y="710" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-41" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="HLwu8Gzehdd7tzMXg7ss-23" target="HLwu8Gzehdd7tzMXg7ss-35">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="400" y="490" as="targetPoint" />
            <Array as="points">
              <mxPoint x="160" y="890" />
              <mxPoint x="281" y="890" />
              <mxPoint x="281" y="500" />
              <mxPoint x="390" y="500" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-23" value="df2 20%, 40%, 60%, 80% 값 점수 부여 후 df와 merge" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="80" y="800" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-34" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" source="HLwu8Gzehdd7tzMXg7ss-35" target="HLwu8Gzehdd7tzMXg7ss-37" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-35" value="위 id 로 1년동안 상세페이지 접근 횟수 추출" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="310" y="530" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-36" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" source="HLwu8Gzehdd7tzMXg7ss-37" target="HLwu8Gzehdd7tzMXg7ss-39" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-37" value="추출한 데이터로 df2 생성" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="310" y="620" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-38" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" source="HLwu8Gzehdd7tzMXg7ss-39" target="HLwu8Gzehdd7tzMXg7ss-40" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-39" value="df2 상세 페이지 접근 수 기준 내림차순 정렬" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="310" y="710" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-40" value="df2 20%, 40%, 60%, 80% 값 점수 부여 후 df와 merge" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="310" y="800" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-42" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" source="HLwu8Gzehdd7tzMXg7ss-43" target="HLwu8Gzehdd7tzMXg7ss-45" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-43" value="위 id 로 3년 동안 결제 금액 추출" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="540" y="530" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-44" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" source="HLwu8Gzehdd7tzMXg7ss-45" target="HLwu8Gzehdd7tzMXg7ss-47" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-45" value="추출한 데이터로 df2 생성" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="540" y="620" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-46" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" source="HLwu8Gzehdd7tzMXg7ss-47" target="HLwu8Gzehdd7tzMXg7ss-48" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-47" value="df2 결제 금액 기준 내림차순 정렬" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="540" y="710" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-52" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="HLwu8Gzehdd7tzMXg7ss-48" target="HLwu8Gzehdd7tzMXg7ss-51">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-48" value="df2 20%, 40%, 60%, 80% 값 점수 부여 후 df와 merge" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="540" y="800" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-49" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="HLwu8Gzehdd7tzMXg7ss-40" target="HLwu8Gzehdd7tzMXg7ss-43">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="620" y="530" as="targetPoint" />
            <mxPoint x="390" y="860" as="sourcePoint" />
            <Array as="points">
              <mxPoint x="390" y="890" />
              <mxPoint x="511" y="890" />
              <mxPoint x="511" y="500" />
              <mxPoint x="620" y="500" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-50" value="&lt;div&gt;rfm 테이블 truncate 후&amp;nbsp;&lt;br&gt;&lt;/div&gt;rfm 테이블에 df 내용 insert" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="354" y="1040" width="126" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-53" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="HLwu8Gzehdd7tzMXg7ss-51" target="HLwu8Gzehdd7tzMXg7ss-50">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HLwu8Gzehdd7tzMXg7ss-51" value="rfm 합산, 합산 값 유저&amp;nbsp; 계층 부여" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="354" y="950" width="126" height="60" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
